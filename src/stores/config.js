// noinspection JSUnresolvedReference
/*--------------------------------------------------------------------------------------------------------------------*/

import { defineStore } from 'pinia';

/*--------------------------------------------------------------------------------------------------------------------*/
/* FUNCTION                                                                                                           */
/*--------------------------------------------------------------------------------------------------------------------*/

const copyDict = (dst, src) => {

    if(typeof dst === 'object'
       &&
       typeof src === 'object'
    ) {
        Object.keys(dst).forEach((key) => delete dst[key]);

        Object.assign(dst, src);
    }

    return dst;
}

/*--------------------------------------------------------------------------------------------------------------------*/
/* STORE                                                                                                              */
/*--------------------------------------------------------------------------------------------------------------------*/

const useConfigStore = defineStore('config', {
    state: () => {
        return {
            globals: {
                mqttURL: '',
                mqttUsername: '',
                mqttPassword: '',
                /**/
                nodeRedURL: '',
            },
        };
    },
    actions: {

        /*------------------------------------------------------------------------------------------------------------*/
        /* CONFIG                                                                                                     */
        /*------------------------------------------------------------------------------------------------------------*/

        load()
        {
            try
            {
                const config = JSON.parse(localStorage.getItem('indi-dashboard-config'));

                copyDict(this.globals, config);
            }
            catch(e)
            {
                /* IGNORE */
            }
        },

        /*------------------------------------------------------------------------------------------------------------*/

        save()
        {
            const json = JSON.stringify(copyDict({}, this.globals));

            localStorage.setItem('indi-dashboard-config', json);
        },

        /*------------------------------------------------------------------------------------------------------------*/
    },
});

/*--------------------------------------------------------------------------------------------------------------------*/

export default useConfigStore;

/*--------------------------------------------------------------------------------------------------------------------*/
