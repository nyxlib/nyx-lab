/*--------------------------------------------------------------------------------------------------------------------*/
/*--------------------------------------------------------------------------------------------------------------------*/
/* STACK                                                                                                              */
/*--------------------------------------------------------------------------------------------------------------------*/

const _throwError = () => {

    throw Error();
}

/*--------------------------------------------------------------------------------------------------------------------*/

const _getStack = () => {

    try
    {
        _throwError();
    }
    catch(e1)
    {
        try
        {
            return e1.stack;
        }
        catch(e2)
        {
            return ((('')));
        }
    }
}

/*--------------------------------------------------------------------------------------------------------------------*/
/* LOCK                                                                                                               */
/*--------------------------------------------------------------------------------------------------------------------*/

let _curLockCnt = 0;

/*--------------------------------------------------------------------------------------------------------------------*/

/**
 * Locks the Web application
 * @ignore
 */

const _lock = () => {

    let lines = _getStack().split('\n');

    if(lines.length > 3)
    {
        console.log(`lock[${_curLockCnt}] :: ${lines[3]}`); // eslint-disable-line no-console
    }

    /**/

    if(_curLockCnt <= 0)
    {
        document.getElementById('nyx_locker').style.display = 'flex';

        _curLockCnt = 1;
    }
    else
    {
        _curLockCnt++;
    }
}

/*--------------------------------------------------------------------------------------------------------------------*/

const _unlock = () => {

    if(_curLockCnt <= 1)
    {
        document.getElementById('nyx_locker').style.display = 'none';

        _curLockCnt = 0;
    }
    else
    {
        _curLockCnt--;
    }

    /**/

    let lines = _getStack().split('\n');

    if(lines.length > 3)
    {
        console.log(`unlock[${_curLockCnt}] :: ${lines[3]}`); // eslint-disable-line no-console
    }
};

/*--------------------------------------------------------------------------------------------------------------------*/

export default {

    install(app)
    {
        app.provide('locker', {
            lock: _lock,
            unlock: _unlock
        });
    }
};

/*--------------------------------------------------------------------------------------------------------------------*/
