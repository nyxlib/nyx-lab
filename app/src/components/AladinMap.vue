<!--suppress CssUnusedSymbol, CssNoGenericFontName -->
<script setup>
/*--------------------------------------------------------------------------------------------------------------------*/

import {ref, watch, onMounted} from 'vue';

import A from 'aladin-lite';

/*--------------------------------------------------------------------------------------------------------------------*/
/* VARIABLES                                                                                                          */
/*--------------------------------------------------------------------------------------------------------------------*/

const props = defineProps({
    fov: {
        type: Number,
        default: 360,
    },
    target: {
        type: String,
        default: 'M45',
    },
    frame: {
        type: String,
        default: 'j2000',
        validator: (value) => {
            return ['off', 'j2000', 'j2000d', 'galactic'].includes(value)
        }
    },
});

/*--------------------------------------------------------------------------------------------------------------------*/

const divEl = ref(null);

/*--------------------------------------------------------------------------------------------------------------------*/

let skymap = null;

/*--------------------------------------------------------------------------------------------------------------------*/
/* INITIALIZATION                                                                                                     */
/*--------------------------------------------------------------------------------------------------------------------*/

onMounted(() => {

    /*----------------------------------------------------------------------------------------------------------------*/

    watch(() => props.target, (value) => {

        skymap.gotoObject(value);
    });

    /*----------------------------------------------------------------------------------------------------------------*/

    watch(() => props.frame, (value) => {

        if(value !== 'off')
        {
            skymap.setFrame(value);

            skymap.showCooGrid();
        }
        else
        {
            skymap.hideCooGrid();
        }
    });

    /*----------------------------------------------------------------------------------------------------------------*/

    if(divEl.value.clientHeight === 0)
    {
        divEl.value.style.height = `${3.0 * divEl.value.clientWidth / 4.0}px`;
    }

    /*----------------------------------------------------------------------------------------------------------------*/

    A.init.then(() => {

        skymap = A.aladin(divEl.value, {
            log: false,
            fov: props.fov,
            projection: 'SIN',
            cooFrame: props.frame,
            /**/
            target: props.target,
            /**/
            showFov: false,
            showFrame: false,
            showReticle: false,
            showStatusBar: false,
            showCooLocation: false,
            showZoomControl: false,
            showFullscreenControl: false,
            showProjectionControl: false,
            /**/
            showCooGrid: true,
            showLayersControl: true,
            /**/
            gridOptions: {
                color: '#FF0000',
                labelSize: 10,
            }
        });
    });

    /*----------------------------------------------------------------------------------------------------------------*/
});

/*--------------------------------------------------------------------------------------------------------------------*/
</script>

<template>

    <!-- *********************************************************************************************************** -->

    <div class="h-100 w-100" ref="divEl"></div>

    <!-- *********************************************************************************************************** -->

</template>
